

<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  
  
  <title>Understanding persistent storage for MicroShift | Storage | MicroShift Branch Build</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/search.css" rel="stylesheet" media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/autumn.css" rel="stylesheet"  media="screen"/>
  <link href="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" type="image/png"/>
  <link href="https://assets.openshift.net/content/subdomain/favicon32x32.png" rel="shortcut icon" type="text/css"/>
  <link href="https://assets.openshift.net/content/osh-nav-footer.css" rel="stylesheet" type="text/css" media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/docs.css" rel="stylesheet"  media="screen"/>
  <link href="https://docs.openshift.com/container-platform/4.1/_stylesheets/print.css" rel="stylesheet" type="text/css" media="print"/>
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" name="msapplication-TileImage">

  <!-- Adobe DTM -->
  <script src="//www.redhat.com/dtm.js" type="text/javascript"></script>
  <!-- End Adobe DTM -->

  <script id="trustarc" src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
        rel="stylesheet">

</head>

<body onload="selectVersion('Branch Build');">
  
<nav id="main">
  <div class="container">
    <div class="row">
      <div class="navbar navbar-default navbar-openshift" role="navigation">
        <div class="navbar-header">
            <a href="#nav-main" class="dropdown-toggle navbar-menu-toggle hidden visible-xs" data-toggle="collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
          <a class="navbar-brand" href="/"></a>
        </div>
        <div id="nav-main" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li id="products" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                Products <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-column flex-md-row">
                  <div class="col-xs-12 col-sm-3">
                    <h3>Overview</h3>
                    <ul class="nav flex-column">
                      <li><a target="_blank" href="https://www.openshift.com/products/features/">Features</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/products/pricing/">Pricing</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-9">
                    <h3>Featured Products</h3>
                    <ul class="nav">
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/container-platform/">Red Hat OpenShift Container&nbsp;Platform</a>
                        <p class="d-none d-md-block">Build, deploy and manage your applications across cloud- and on-premise infrastructure</p>
                      </li>
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/dedicated/">Red Hat OpenShift Dedicated</a>
                        <p class="d-none d-md-block">Single-tenant, high-availability Kubernetes clusters in the public cloud</p>
                      </li>

                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/online/">Red Hat OpenShift Online</a>
                        <p class="d-none d-md-block">The fastest way for developers to build, host and scale applications in the public cloud</p>
                      </li>

                      <li class="nav-item">
                        <a target="_blank" href="https://www.openshift.com/products/">All products <span class="fa fa-angle-right"></span></a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li id="learn" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Learn <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-md-nowrap">
                  <div class="col-xs-12 col-sm-6">
                    <h3>Learn</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/what-is-openshift/">What is OpenShift</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/get-started/">Get started</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/partners/">Partners</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/success-stories/">Customer success stories</a></li>
                      <li><a target="_blank" href="https://blog.openshift.com">Blog</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/resources/">Resources</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-6">
                    <h3>Technology Topics</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/knative/">Knative</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/security/">Security</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/kubernetes/">Kubernetes</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/service-brokers/">Service Brokers</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Community <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://commons.openshift.org">OpenShift Commons</a></li>
                <li><a target="_blank" href="https://www.okd.io">Open Source (OKD)</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/startups/">Startups</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/grants/">Grants</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Support <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://help.openshift.com">Help Center</a></li>
                <li><a href="https://docs.openshift.com">OpenShift Docs</a></li>
              </ul>
            </li>

            <li><a target="_blank" class="nav-sign-up" href="https://www.openshift.com/trial/">Free Trial</a></li>

            <li><a target="_blank" href="https://console.redhat.com/openshift" class="nav-sign-in">Log In <span class="fa fa-angle-right"></span></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</nav>

  
  <div class="container">
    <button id="hc-open-btn" class="open-btn-sm" onclick="openNav()" aria-label="Open"><span class="fa fa-bars" /></button>
    <ol class="breadcrumb hide-for-print">
      

      

      

      

      

      

      <li class="sitename">
        <a href="/">
          Documentation</a>
      </li>
      <li class="hidden-xs active">
        
          <a href="../microshift_welcome/index.html">MicroShift Branch Build</a>
        
      </li>
      <li class="hidden-xs active">
        <a href="../microshift_storage/index.html">Storage</a>
      </li>
      
      
      <li class="hidden-xs active">
        Understanding persistent storage for MicroShift
      </li>
      
      <span text-align="right" style="float: right !important">
        <a href="https://github.com/openshift/openshift-docs/commits/main/microshift_storage/understanding-persistent-storage-microshift.adoc"><span class="material-icons-outlined" title="Page history">history</span></a>
        
        <a href="https://issues.redhat.com/secure/CreateIssueDetails!init.jspa?pid=12332330&issuetype=1&components=12367614&priority=4&summary=[microshift-Branch Build]+Issue+in+file+microshift_storage/understanding-persistent-storage-microshift.adoc">
          <span class="material-icons-outlined" title="Open an issue">bug_report</span>
        </a>
        <a href="javascript: void(0);" onclick="window.print()"><span class="material-icons-outlined" title="Print page (Save as PDF)">picture_as_pdf</span></a>
        
        
      </span>
      
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas hide-for-print">
        <div class="row-fluid">
          <div id="btn-close">
            <button id="hc-close-btn" onclick="closeNav()" class="close-btn-sm" aria-label="close"><span class="fa fa-times" /></button>
          </div>
          <div id="hc-search">
            <input id="hc-search-input" type="text" aria-label="search">
            <button id="hc-search-btn" aria-label="search"><span class="fa fa-search" /></button>
          </div>
        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0"><span id="tgSpan0" class="fa fa-angle-right"></span>About</a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_welcome/index.html">Welcome</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1"><span id="tgSpan1" class="fa fa-angle-right"></span>Release notes</a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_release_notes/microshift-4-14-release-notes.html">MicroShift 4.14 release notes</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup2"><span id="tgSpan2" class="fa fa-angle-right"></span>Getting started</a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_getting_started/microshift-understanding.html">Understanding MicroShift</a></li>
            <li><a class="" href="../microshift_getting_started/microshift-architecture.html">Architecture</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup3"><span id="tgSpan3" class="fa fa-angle-right"></span>Installing</a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_install/microshift-install-rpm.html">Installing from RPM</a></li>
            <li><a class="" href="../microshift_install/microshift-embed-in-rpm-ostree.html">Embedding in a RHEL for Edge image</a></li>
            <li><a class="" href="../microshift_install/microshift-greenboot.html">Greenboot health check</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup4"><span id="tgSpan4" class="fa fa-angle-right"></span>Updating clusters</a>
      <ul id="topicGroup4" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_updating/microshift-about-updates.html">About MicroShift updates</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup5"><span id="tgSpan5" class="fa fa-angle-right"></span>Support</a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_support/microshift-etcd.html">MicroShift etcd</a></li>
            <li><a class="" href="../microshift_support/microshift-sos-report.html">MicroShift sos report</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup6"><span id="tgSpan6" class="fa fa-angle-right"></span>API reference</a>
      <ul id="topicGroup6" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_rest_api/understanding-api-support-tiers.html">Understanding API tiers</a></li>
            <li><a class="" href="../microshift_rest_api/understanding-compatibility-guidelines.html">API compatibility guidelines</a></li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-6-2"><span id="sgSpan-6-2" class="fa fa-caret-right"></span>&nbsp;Network APIs</a>
              <ul id="topicSubGroup-6-2" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../microshift_rest_api/network_apis/route-route-openshift-io-v1.html">Route [route.openshift.io/v1]</a></li>              </ul>
            </li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-6-3"><span id="sgSpan-6-3" class="fa fa-caret-right"></span>&nbsp;Security APIs</a>
              <ul id="topicSubGroup-6-3" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../microshift_rest_api/security_apis/securitycontextconstraints-security-openshift-io-v1.html">SecurityContextConstraints [security.openshift.io/v1]</a></li>              </ul>
            </li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup7"><span id="tgSpan7" class="fa fa-angle-right"></span>CLI tools</a>
      <ul id="topicGroup7" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_cli_ref/microshift-cli-tools-introduction.html">CLI tools introduction</a></li>
            <li><a class="" href="../microshift_cli_ref/microshift-oc-cli-install.html">Installing the OpenShift CLI</a></li>
            <li><a class="" href="../microshift_cli_ref/microshift-oc-config.html">Configuring the OpenShift CLI</a></li>
            <li><a class="" href="../microshift_cli_ref/microshift-cli-using-oc.html">Using the OpenShift CLI</a></li>
            <li><a class="" href="../microshift_cli_ref/microshift-usage-oc-kubectl.html">Using oc and kubectl</a></li>
            <li><a class="" href="../microshift_cli_ref/microshift-oc-cli-commands-list.html">List of oc CLI commands</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup8"><span id="tgSpan8" class="fa fa-angle-right"></span>Configuring</a>
      <ul id="topicGroup8" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_configuring/microshift-using-config-tools.html">Using configuration tools</a></li>
            <li><a class="" href="../microshift_configuring/microshift-cluster-access-kubeconfig.html">Cluster access with kubeconfig</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup9"><span id="tgSpan9" class="fa fa-angle-right"></span>Networking</a>
      <ul id="topicGroup9" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_networking/microshift-networking.html">Networking settings</a></li>
            <li><a class="" href="../microshift_networking/microshift-firewall.html">Firewall configuration</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup10"><span id="tgSpan10" class="fa fa-angle-down"></span>Storage</a>
      <ul id="topicGroup10" class="collapse in list-unstyled">
            <li><a class="" href="../microshift_storage/index.html">MicroShift storage overview</a></li>
            <li><a class="" href="../microshift_storage/understanding-ephemeral-storage-microshift.html">Understanding ephemeral storage for MicroShift</a></li>
            <li><a class="" href="../microshift_storage/generic-ephemeral-volumes-microshift.html">Generic ephemeral volumes for MicroShift</a></li>
            <li><a class=" active" href="../microshift_storage/understanding-persistent-storage-microshift.html">Understanding persistent storage for MicroShift</a></li>
            <li><a class="" href="../microshift_storage/expanding-persistent-volumes-microshift.html">Expanding persistent volumes for MicroShift</a></li>
            <li><a class="" href="../microshift_storage/microshift-storage-plugin-overview.html">Dynamic storage using the LVMS plugin</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup11"><span id="tgSpan11" class="fa fa-angle-right"></span>Running applications</a>
      <ul id="topicGroup11" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_running_apps/microshift-applications.html">Application deployment</a></li>
            <li><a class="" href="../microshift_running_apps/microshift-operators.html">Operators</a></li>
      </ul>
    </li>
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup12"><span id="tgSpan12" class="fa fa-angle-right"></span>Troubleshooting</a>
      <ul id="topicGroup12" class="collapse  list-unstyled">
            <li><a class="" href="../microshift_troubleshooting/microshift-version.html">Checking your version</a></li>
            <li><a class="" href="../microshift_troubleshooting/microshift-things-to-know.html">Additional information</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div id="hc-search-modal">
        <div id="hc-modal-content">
          <span id="hc-modal-close">&times;</span>
          <div id="hc-search-results-wrapper">
            <div id="hc-search-results"></div>
            <div id="hc-search-progress-indicator" class="text-center search-progress-indicator"><i class="fa fa-circle-o-notch fa-spin" style="font-size:42px"></i></div>
            <div class="text-center">
              <button id="hc-search-more-btn">Show more results</button>
            </div>
          </div>
        </div>
      </div>
      <div class="print-logo" style="display:none;">
        <img src="https://www.redhat.com/cms/managed-files/Logo-Red_Hat-OpenShift-A-Standard-RGB_0_0.svg" alt="print logo"/>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h1>
            Understanding persistent storage for MicroShift
          </h1>
        </div>
        
        
        <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#persistent-storage-overview_understanding-persistent-storage-microshift">Persistent storage overview</a></li>
<li><a href="#lifecycle-volume-claim_understanding-persistent-storage-microshift">Lifecycle of a volume and claim</a>
<ul class="sectlevel2">
<li><a href="#provisioning_understanding-persistent-storage-microshift">Provision storage</a></li>
<li><a href="#binding_understanding-persistent-storage-microshift">Bind claims</a></li>
<li><a href="#using-pods_understanding-persistent-storage-microshift">Use pods and claimed PVs</a></li>
<li><a href="#releasing_understanding-persistent-storage-microshift">Release a persistent volume</a></li>
<li><a href="#reclaiming_understanding-persistent-storage-microshift">Reclaim policy for persistent volumes</a></li>
<li><a href="#reclaim-manual_understanding-persistent-storage-microshift">Reclaiming a persistent volume manually</a></li>
<li><a href="#reclaim-policy_understanding-persistent-storage-microshift">Changing the reclaim policy of a persistent volume</a></li>
</ul>
</li>
<li><a href="#persistent-volumes_understanding-persistent-storage-microshift">Persistent volumes</a>
<ul class="sectlevel2">
<li><a href="#pv-capacity_understanding-persistent-storage-microshift">Capacity</a></li>
<li><a href="#supported-access-modes">Supported access modes</a></li>
<li><a href="#pv-phase_understanding-persistent-storage-microshift">Phase</a></li>
</ul>
</li>
<li><a href="#persistent-volume-claims_understanding-persistent-storage-microshift">Persistent volume claims</a>
<ul class="sectlevel2">
<li><a href="#pvc-storage-class_understanding-persistent-storage-microshift">Storage classes</a></li>
<li><a href="#pvc-access-modes_understanding-persistent-storage-microshift">Access modes</a></li>
<li><a href="#pvc-resources_understanding-persistent-storage-microshift">Resources</a></li>
<li><a href="#pvc-claims-as-volumes_understanding-persistent-storage-microshift">Claims as volumes</a></li>
</ul>
</li>
<li><a href="#using_fsGroup_understanding-persistent-storage-microshift">Using fsGroup to reduce pod timeouts</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>Managing storage is a distinct problem from managing compute resources. MicroShift uses the Kubernetes persistent volume (PV) framework to allow cluster administrators to provision persistent storage for a cluster. Developers can use persistent volume claims (PVCs) to request PV resources without having specific knowledge of the underlying storage infrastructure.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="persistent-storage-overview_understanding-persistent-storage-microshift"><a class="anchor" href="#persistent-storage-overview_understanding-persistent-storage-microshift"></a>Persistent storage overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PVCs are specific to a namespace, and are created and used by developers as a means to use a PV. PV resources on their own are not scoped to any single namespace; they can be shared across the entire MicroShift cluster and claimed from any namespace. After a PV is bound to a PVC, that PV can not then be bound to additional PVCs. This has the effect of scoping a bound PV to a single namespace.</p>
</div>
<div class="paragraph">
<p>PVs are defined by a <code>PersistentVolume</code> API object, which represents a piece of existing storage in the cluster that was either statically provisioned by the cluster administrator or dynamically provisioned using a <code>StorageClass</code> object. It is a resource in the cluster just like a node is a cluster resource.</p>
</div>
<div class="paragraph">
<p>PVs are volume plugins like <code>Volumes</code> but have a lifecycle that is independent of any individual pod that uses the PV. PV objects capture the details of the implementation of the storage, be that LVM, the host filesystem such as hostpath, or raw block devices.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>High availability of storage in the infrastructure is left to the underlying storage provider.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Like <code>PersistentVolumes</code>, <code>PersistentVolumeClaims</code> (PVCs) are API objects, which represents a request for storage by a developer. It is similar to a pod in that pods consume node resources and PVCs consume PV resources. For example, pods can request specific levels of resources, such as CPU and memory, while PVCs can request specific storage capacity and access modes. Access modes supported by OpenShift Container Platform are also definable in MicroShift. However, because MicroShift does not support multi-node deployments, only ReadWriteOnce (RWO) is pertinent.</p>
</div>
<div id="additional-resources_understanding-persistent-storage-microshift" class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.13/html/storage/understanding-persistent-storage#pv-access-modes_understanding-persistent-storage">Access modes for persistent storage</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lifecycle-volume-claim_understanding-persistent-storage-microshift"><a class="anchor" href="#lifecycle-volume-claim_understanding-persistent-storage-microshift"></a>Lifecycle of a volume and claim</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PVs are resources in the cluster. PVCs are requests for those resources
and also act as claim checks to the resource. The interaction between PVs
and PVCs have the following lifecycle.</p>
</div>
<div class="sect2">
<h3 id="provisioning_understanding-persistent-storage-microshift"><a class="anchor" href="#provisioning_understanding-persistent-storage-microshift"></a>Provision storage</h3>
<div class="paragraph">
<p>In response to requests from a developer defined in a PVC, a cluster
administrator configures one or more dynamic provisioners that provision
storage and a matching PV.</p>
</div>
</div>
<div class="sect2">
<h3 id="binding_understanding-persistent-storage-microshift"><a class="anchor" href="#binding_understanding-persistent-storage-microshift"></a>Bind claims</h3>
<div class="paragraph">
<p>When you create a PVC, you request a specific amount of storage, specify the
required access mode, and create a storage class to describe and classify
the storage. The control loop in the master watches for new PVCs and binds
the new PVC to an appropriate PV. If an appropriate PV does not exist, a
provisioner for the storage class creates one.</p>
</div>
<div class="paragraph">
<p>The size of all PVs might exceed your PVC size. This is especially true
with manually provisioned PVs. To minimize the excess, MicroShift
binds to the smallest PV that matches all other criteria.</p>
</div>
<div class="paragraph">
<p>Claims remain unbound indefinitely if a matching volume does not exist or
can not be created with any available provisioner servicing a storage
class. Claims are bound as matching volumes become available. For example,
a cluster with many manually provisioned 50Gi volumes would not match a
PVC requesting 100Gi. The PVC can be bound when a 100Gi PV is added to the
cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-pods_understanding-persistent-storage-microshift"><a class="anchor" href="#using-pods_understanding-persistent-storage-microshift"></a>Use pods and claimed PVs</h3>
<div class="paragraph">
<p>Pods use claims as volumes. The cluster inspects the claim to find the bound
volume and mounts that volume for a pod. For those volumes that support
multiple access modes, you must specify which mode applies when you use
the claim as a volume in a pod.</p>
</div>
<div class="paragraph">
<p>Once you have a claim and that claim is bound, the bound PV belongs to you
for as long as you need it. You can schedule pods and access claimed
PVs by including <code>persistentVolumeClaim</code> in the pod&#8217;s volumes block.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you attach persistent volumes that have high file counts to pods, those pods can fail or can take a long time to start. For
more information, see <a href="https://access.redhat.com/solutions/6221251">When using Persistent Volumes with high file counts in OpenShift, why do pods fail to start or take an excessive amount of time to achieve "Ready" state?</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="releasing_understanding-persistent-storage-microshift"><a class="anchor" href="#releasing_understanding-persistent-storage-microshift"></a>Release a persistent volume</h3>
<div class="paragraph">
<p>When you are finished with a volume, you can delete the PVC object from
the API, which allows reclamation of the resource. The volume is
considered released when the claim is deleted, but it is not yet available
for another claim. The previous claimant&#8217;s data remains on the volume and
must be handled according to policy.</p>
</div>
</div>
<div class="sect2">
<h3 id="reclaiming_understanding-persistent-storage-microshift"><a class="anchor" href="#reclaiming_understanding-persistent-storage-microshift"></a>Reclaim policy for persistent volumes</h3>
<div class="paragraph">
<p>The reclaim policy of a persistent volume tells the cluster what to do with the volume after it is released. A volume&#8217;s reclaim policy can be
<code>Retain</code>, <code>Recycle</code>, or <code>Delete</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Retain</code> reclaim policy allows manual reclamation of the resource for
those volume plugins that support it.</p>
</li>
<li>
<p><code>Recycle</code> reclaim policy recycles the volume back into the pool of
unbound persistent volumes once it is released from its claim.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>Recycle</code> reclaim policy is deprecated in MicroShift 4. Dynamic provisioning is recommended for equivalent and better
functionality.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Delete</code> reclaim policy deletes  both the <code>PersistentVolume</code> object
from MicroShift and the associated storage asset in external
infrastructure, such as AWS EBS or VMware vSphere.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dynamically provisioned volumes are always deleted.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="reclaim-manual_understanding-persistent-storage-microshift"><a class="anchor" href="#reclaim-manual_understanding-persistent-storage-microshift"></a>Reclaiming a persistent volume manually</h3>
<div class="paragraph">
<p>When a persistent volume claim (PVC) is deleted, the underlying logical volume is handled according to the <code>reclaimPolicy</code>.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To manually reclaim the PV as a cluster administrator:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the PV.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc delete pv &lt;pv-name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The associated storage asset in the external infrastructure, such as an AWS EBS, GCE PD, Azure Disk, or Cinder volume, still exists after the PV is deleted.</p>
</div>
</li>
<li>
<p>Clean up the data on the associated storage asset.</p>
</li>
<li>
<p>Delete the associated storage asset. Alternately, to reuse the same storage asset, create a new PV with the storage asset definition.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The reclaimed PV is now available for use by another PVC.</p>
</div>
</div>
<div class="sect2">
<h3 id="reclaim-policy_understanding-persistent-storage-microshift"><a class="anchor" href="#reclaim-policy_understanding-persistent-storage-microshift"></a>Changing the reclaim policy of a persistent volume</h3>
<div class="paragraph">
<p>To change the reclaim policy of a persistent volume:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>List the persistent volumes in your cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get pv</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="go">NAME                                       CAPACITY   ACCESSMODES   RECLAIMPOLICY   STATUS    CLAIM             STORAGECLASS     REASON    AGE
 pvc-b6efd8da-b7b5-11e6-9d58-0ed433a7dd94   4Gi        RWO           Delete          Bound     default/claim1    manual                     10s
 pvc-b95650f8-b7b5-11e6-9d58-0ed433a7dd94   4Gi        RWO           Delete          Bound     default/claim2    manual                     6s
 pvc-bb3ca71d-b7b5-11e6-9d58-0ed433a7dd94   4Gi        RWO           Delete          Bound     default/claim3    manual                     3s</span></code></pre>
</div>
</div>
</li>
<li>
<p>Choose one of your persistent volumes and change its reclaim policy:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc patch pv &lt;your-pv-name&gt; <span class="nt">-p</span> <span class="s1">'{"spec":{"persistentVolumeReclaimPolicy":"Retain"}}'</span></code></pre>
</div>
</div>
</li>
<li>
<p>Verify that your chosen persistent volume has the right policy:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get pv</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="go">NAME                                       CAPACITY   ACCESSMODES   RECLAIMPOLICY   STATUS    CLAIM             STORAGECLASS     REASON    AGE
 pvc-b6efd8da-b7b5-11e6-9d58-0ed433a7dd94   4Gi        RWO           Delete          Bound     default/claim1    manual                     10s
 pvc-b95650f8-b7b5-11e6-9d58-0ed433a7dd94   4Gi        RWO           Delete          Bound     default/claim2    manual                     6s
 pvc-bb3ca71d-b7b5-11e6-9d58-0ed433a7dd94   4Gi        RWO           Retain          Bound     default/claim3    manual                     3s</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding output, the volume bound to claim <code>default/claim3</code> now has a <code>Retain</code> reclaim policy. The volume will not be automatically deleted when a user deletes claim <code>default/claim3</code>.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="persistent-volumes_understanding-persistent-storage-microshift"><a class="anchor" href="#persistent-volumes_understanding-persistent-storage-microshift"></a>Persistent volumes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each PV contains a <code>spec</code> and <code>status</code>, which is the specification and status of the volume, for example:</p>
</div>
<div class="listingblock">
<div class="title"><code>PersistentVolume</code> object definition example</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">pv0001</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">5Gi</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadWriteOnce</span> <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="na">persistentVolumeReclaimPolicy</span><span class="pi">:</span> <span class="s">Retain</span> <i class="conum" data-value="4"></i><b>(4)</b>
  <span class="s">...</span>
<span class="na">status</span><span class="pi">:</span>
  <span class="s">...</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Name of the persistent volume.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The amount of storage available to the volume.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The access mode, defining the read-write and mount permissions.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The reclaim policy, indicating how the resource should be handled once it is released.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="pv-capacity_understanding-persistent-storage-microshift"><a class="anchor" href="#pv-capacity_understanding-persistent-storage-microshift"></a>Capacity</h3>
<div class="paragraph">
<p>Generally, a persistent volume (PV) has a specific storage capacity. This is set by using the <code>capacity</code> attribute of the PV.</p>
</div>
<div class="paragraph">
<p>Currently, storage capacity is the only resource that can be set or requested. Future attributes may include IOPS, throughput, and so on.</p>
</div>
</div>
<div class="sect2">
<h3 id="supported-access-modes"><a class="anchor" href="#supported-access-modes"></a>Supported access modes</h3>
<div class="paragraph">
<p>LVMS is the only CSI plugin MicroShift supports. The hostPath and LVs built in to OpenShift Container Platform also support RWO.</p>
</div>
</div>
<div class="sect2">
<h3 id="pv-phase_understanding-persistent-storage-microshift"><a class="anchor" href="#pv-phase_understanding-persistent-storage-microshift"></a>Phase</h3>
<div class="paragraph">
<p>Volumes can be found in one of the following phases:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Volume phases</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Phase</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A free resource not yet bound to a claim.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bound</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The volume is bound to a claim.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Released</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The claim was deleted, but the resource is not yet reclaimed by the
cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The volume has failed its automatic reclamation.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can view the name of the PVC bound to the PV by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get pv &lt;pv-claim&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="pv-mount-options_understanding-persistent-storage-microshift"><a class="anchor" href="#pv-mount-options_understanding-persistent-storage-microshift"></a>Mount options</h4>
<div class="paragraph">
<p>You can specify mount options while mounting a PV by using the attribute <code>mountOptions</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="title">Mount options example</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolume</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">pv0001</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">capacity</span><span class="pi">:</span>
    <span class="na">storage</span><span class="pi">:</span> <span class="s">1Gi</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadWriteOnce</span>
  <span class="na">mountOptions</span><span class="pi">:</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="pi">-</span> <span class="s">nfsvers=4.1</span>
  <span class="na">nfs</span><span class="pi">:</span>
    <span class="na">path</span><span class="pi">:</span> <span class="s">/tmp</span>
    <span class="na">server</span><span class="pi">:</span> <span class="s">172.17.0.2</span>
  <span class="na">persistentVolumeReclaimPolicy</span><span class="pi">:</span> <span class="s">Retain</span>
  <span class="na">claimRef</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">claim1</span>
    <span class="na">namespace</span><span class="pi">:</span> <span class="s">default</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Specified mount options are used while mounting the PV to the disk.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following PV types support mount options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AWS Elastic Block Store (EBS)</p>
</li>
<li>
<p>Azure Disk</p>
</li>
<li>
<p>Azure File</p>
</li>
<li>
<p>Cinder</p>
</li>
<li>
<p>GCE Persistent Disk</p>
</li>
<li>
<p>iSCSI</p>
</li>
<li>
<p>Local volume</p>
</li>
<li>
<p>NFS</p>
</li>
<li>
<p>{rh-storage-first} (Ceph RBD only)</p>
</li>
<li>
<p>VMware vSphere</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Fibre Channel and HostPath PVs do not support mount options.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="persistent-volume-claims_understanding-persistent-storage-microshift"><a class="anchor" href="#persistent-volume-claims_understanding-persistent-storage-microshift"></a>Persistent volume claims</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each <code>PersistentVolumeClaim</code> object contains a <code>spec</code> and <code>status</code>, which
is the specification and status of the persistent volume claim (PVC), for example:</p>
</div>
<div class="listingblock">
<div class="title"><code>PersistentVolumeClaim</code> object definition example</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">kind</span><span class="pi">:</span> <span class="s">PersistentVolumeClaim</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myclaim</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">accessModes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">ReadWriteOnce</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="na">resources</span><span class="pi">:</span>
    <span class="na">requests</span><span class="pi">:</span>
      <span class="na">storage</span><span class="pi">:</span> <span class="s">8Gi</span> <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="na">storageClassName</span><span class="pi">:</span> <span class="s">gold</span> <i class="conum" data-value="4"></i><b>(4)</b>
<span class="na">status</span><span class="pi">:</span>
  <span class="s">...</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Name of the PVC</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The access mode, defining the read-write and mount permissions</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The amount of storage available to the PVC</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Name of the <code>StorageClass</code> required by the claim</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="pvc-storage-class_understanding-persistent-storage-microshift"><a class="anchor" href="#pvc-storage-class_understanding-persistent-storage-microshift"></a>Storage classes</h3>
<div class="paragraph">
<p>Claims can optionally request a specific storage class by specifying the
storage class&#8217;s name in the <code>storageClassName</code> attribute. Only PVs of the
requested class, ones with the same <code>storageClassName</code> as the PVC, can be
bound to the PVC. The cluster administrator can configure dynamic
provisioners to service one or more storage classes. The cluster
administrator can create a PV on demand that matches the specifications
in the PVC.</p>
</div>
<div class="paragraph">
<p>The cluster administrator can also set a default storage class for all PVCs.
When a default storage class is configured, the PVC must explicitly ask for
<code>StorageClass</code> or <code>storageClassName</code> annotations set to <code>""</code> to be bound
to a PV without a storage class.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If more than one storage class is marked as default, a PVC can only be created if the <code>storageClassName</code> is explicitly specified. Therefore, only one storage class should be set as the default.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="pvc-access-modes_understanding-persistent-storage-microshift"><a class="anchor" href="#pvc-access-modes_understanding-persistent-storage-microshift"></a>Access modes</h3>
<div class="paragraph">
<p>Claims use the same conventions as volumes when requesting storage with
specific access modes.</p>
</div>
</div>
<div class="sect2">
<h3 id="pvc-resources_understanding-persistent-storage-microshift"><a class="anchor" href="#pvc-resources_understanding-persistent-storage-microshift"></a>Resources</h3>
<div class="paragraph">
<p>Claims, such as pods, can request specific quantities of a resource. In
this case, the request is for storage. The same resource model applies to
volumes and claims.</p>
</div>
</div>
<div class="sect2">
<h3 id="pvc-claims-as-volumes_understanding-persistent-storage-microshift"><a class="anchor" href="#pvc-claims-as-volumes_understanding-persistent-storage-microshift"></a>Claims as volumes</h3>
<div class="paragraph">
<p>Pods access storage by using the claim as a volume. Claims must exist in the
same namespace as the pod using the claim. The cluster finds the claim
in the pod&#8217;s namespace and uses it to get the <code>PersistentVolume</code> backing
the claim. The volume is mounted to the host and into the pod, for example:</p>
</div>
<div class="listingblock">
<div class="title">Mount volume to the host and into the pod example</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">mypod</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myfrontend</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">dockerfile/nginx</span>
      <span class="na">volumeMounts</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">mountPath</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/var/www/html"</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="na">name</span><span class="pi">:</span> <span class="s">mypd</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">mypd</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span> <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Path to mount the volume inside the pod.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Name of the volume to mount. Do not mount to the container root, <code>/</code>, or any path that is the same in the host and the container. This can corrupt your host system if the container is sufficiently privileged, such as the host <code>/dev/pts</code> files. It is safe to mount the host by using <code>/host</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Name of the PVC, that exists in the same namespace, to use.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using_fsGroup_understanding-persistent-storage-microshift"><a class="anchor" href="#using_fsGroup_understanding-persistent-storage-microshift"></a>Using fsGroup to reduce pod timeouts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a storage volume contains many files (~1,000,000 or greater), you may experience pod timeouts.</p>
</div>
<div class="paragraph">
<p>This can occur because, by default, MicroShift recursively changes ownership and permissions for the contents of each volume to match the <code>fsGroup</code> specified in a pod&#8217;s <code>securityContext</code> when that volume is mounted. For large volumes, checking and changing ownership and permissions can be time consuming, slowing pod startup. You can use the <code>fsGroupChangePolicy</code> field inside a <code>securityContext</code> to control the way that MicroShift checks and manages ownership and permissions for a volume.</p>
</div>
<div class="paragraph">
<p><code>fsGroupChangePolicy</code> defines behavior for changing ownership and permission of the volume before being exposed inside a pod. This field only applies to volume types that support <code>fsGroup</code>-controlled ownership and permissions. This field has two possible values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OnRootMismatch</code>: Only change permissions and ownership if permission and ownership of root directory does not match with expected permissions of the volume. This can help shorten the time it takes to change ownership and permission of a volume to reduce pod timeouts.</p>
</li>
<li>
<p><code>Always</code>: Always change permission and ownership of the volume when a volume is mounted.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title"><code>fsGroupChangePolicy</code> example</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">securityContext</span><span class="pi">:</span>
  <span class="na">runAsUser</span><span class="pi">:</span> <span class="m">1000</span>
  <span class="na">runAsGroup</span><span class="pi">:</span> <span class="m">3000</span>
  <span class="na">fsGroup</span><span class="pi">:</span> <span class="m">2000</span>
  <span class="na">fsGroupChangePolicy</span><span class="pi">:</span> <span class="s2">"</span><span class="s">OnRootMismatch"</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="s">...</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>OnRootMismatch</code> specifies skipping recursive permission change, thus helping to avoid pod timeout problems.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The fsGroupChangePolicyfield has no effect on ephemeral volume types, such as secret, configMap, and emptydir.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/nav-tertiary.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/reformat-html.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/hc-search.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/clipboard.js" type="text/javascript"></script>
  <script src="https://docs.openshift.com/container-platform/4.1/_javascripts/collapsible.js" type="text/javascript"></script>
  <script>
  var dk = 'microshift';
  var version = 'Branch Build';

  var distros = {
    'openshift-origin': ['docs_origin', version],
    // specific labels are used for OSD instead of the URL filter, due to its unusual URL structure; assume v4
    'openshift-dedicated': ['docs_dedicated_v4'],
    'openshift-online': ['docs_online', version],
    'openshift-enterprise': ['docs_cp', version],
    'openshift-aro' : ['docs_aro', version],
    'openshift-rosa' : ['docs_rosa'],
    'openshift-acs' : ['docs_acs', version],
    'openshift-serverless' : ['docs_serverless', version]
  };

  // only OSD v3 docs have the version variable specified
  if (dk == "openshift-dedicated" && version == "3") {
    distros['openshift-dedicated'] = ['docs_dedicated_v3']
  }

  distros[dk] ? hcSearchCategory.apply(null, distros[dk]) : hcSearchCategory("docs");
  </script>
  <script type="text/javascript">
  /*<![CDATA[*/
  $(document).ready(function() {
    $("[id^='topicGroup']").on('show.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicGroup']").on('hide.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });

    const collapsibleContent = document.getElementsByTagName("details");
    for (var i = 0; i < collapsibleContent.length; i++) {
      collapsibleContent[i].setAttribute("open", "");
    }

  });
  /*]]>*/
  </script>

  <footer id="rh">

    <div class="container">
        <div class="row">

            <div class="col-sm-2">
                <img src="https://assets.openshift.com/hubfs/images/logos/Logo-RedHat-A-Reverse-RGB.svg" class="img-fluid" alt="Red Hat" style="height: 30px;">
            </div>

            <div class="col-sm-3">
              <p class="text-nowrap">Copyright  2023 Red Hat, Inc.</p>
            </div>



            <div class="col">
                <nav class="nav">
                    <a target="_blank" href="https://www.redhat.com/en/about/privacy-policy" class="nav-link">Privacy statement</a>
                    <a target="_blank" href="https://www.openshift.com/legal/terms/" class="nav-link">Terms of use</a>
                    <a target="_blank" href="https://www.redhat.com/en/about/all-policies-guidelines" class="nav-link">All policies and guidelines</a>
                    <a id="teconsent"></a>
                </nav>
            </div>
        </div>
    </div>
</footer>
<div id="consent_blackbar" style="z-index: 100; position: fixed"></div>



<!-- Adobe DTM -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
   _satellite.pageBottom();
}
</script>
<!-- End Adobe DTM -->

  <!-- adjust page css based on breadcrumb and/or resize -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      }
    });

    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      } else if ($(window).width() < 1008) {
        sidebar.classList.remove('wide');
        document.querySelector('#hc-search').classList.remove('wide');
        if (sidebar.classList.contains('open')) {
          sidebar.style.display = 'block';
        } else {
          sidebar.style.display = 'none';
        }
        document.querySelector('.main').style.paddingTop = '0px';
      }
    });

    function adjustSide() {
      sidebar.classList.add('wide');
      document.querySelector('#hc-search').classList.add('wide');
      sidebar.style.display = 'block';
      document.querySelector('.sidebar').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 125), 10) + "px";
      document.querySelector('#hc-search').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 95), 10) + "px";
    }

    function adjustToc() {
      if (document.querySelector('#toc') !== null) {
        document.querySelector('#toc').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      }
    }

    function adjustMain() {
      document.querySelector('html').style.scrollPaddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      document.querySelector('.main').style.paddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight - 70), 10) + "px";
    }

  </script>

  <!-- remove toc active class when page is loaded -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      var tocItems = $("#toc a");

      for (let i = 0; i < tocItems.length; i++) {
        tocItems[i].classList.remove("toc-active");
      }
    })
  </script>

  <!-- maintain sidebar scroll position between page loads -->
  <script type="text/javascript">
    let sidebar = document.querySelector(".sidebar");
    let scrolltop = localStorage.getItem("sidebar-scroll");

    if (scrolltop == null) {
      sidebar.scrollTop = parseInt(top, 10);
    }

    window.addEventListener("beforeunload", () => {
      localStorage.setItem("sidebar-scroll", sidebar.scrollTop);
    });

    window.addEventListener('load', () => {
      sidebar.scrollTo(0, scrolltop)
    })
  </script>

  <!-- open/close the nav -->
  <script type="text/javascript">
    function closeNav() {
      let sidebar = document.querySelector(".sidebar");
      sidebar.style.display = "none";
      sidebar.classList.remove('open');
    }

    function openNav() {
      let sidebar = document.querySelector(".sidebar");
      let hc_search = document.querySelector('#hc-search');
      sidebar.style.display = "block";
      sidebar.style.top = "0px";
      hc_search.style.top = 'unset';
      sidebar.classList.add('open');
    }
  </script>

  <!-- clear and add toc-active to clicked toc link -->
  <script type="text/javascript">
  $("#toc a").click(function() {
    var tocItems = $("#toc a");
    for (let i = 0; i < tocItems.length; i++) {
      tocItems[i].classList.remove("toc-active");
    }
    this.classList.add("toc-active");
  });
  </script>

  <!-- update active toc class when mouse scrolls -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      window.addEventListener("wheel", () => {

        const ioConfiguration = {
          "rootMargin": "-120px 0px -400px 0px",
          "threshold": 0
        };

        const observer = new IntersectionObserver(setCurrent, ioConfiguration, entries => {
          entries.forEach(entry => {
            var id = entry.target.getAttribute('id');
            //fight with js
            document.querySelector(`#toc li a[href="#${id}"]`).classList.remove('toc-active');
          });
        });

        //track all h1-4 headings that have an id
        document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
          observer.observe(h);
        });

        //runs when the IntersectionObserver fires
        function setCurrent(e) {
          var allTocLinks = document.querySelectorAll("#toc li a");
          if (allTocLinks !== undefined) {
            e.map(i => {
              if (i.isIntersecting && i.intersectionRatio >= 1) {
                allTocLinks.forEach(link => link.classList.remove("toc-active"));
                document.querySelector(`#toc li a[href="#${i.target.id}"]`).classList.add('toc-active')
              }
            })
          }
        };

        //make clicked toc item active and stop IntersectionObserver
        $("#toc a").click(function() {
          //stop tracking all h1-4 headings that have an id
          document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
            observer.unobserve(h);
          });
          var tocItems = $("#toc a");
          if (tocItems !== undefined) {
            for (let i = 0; i < tocItems.length; i++) {
              tocItems[i].classList.remove("toc-active");
            };
            this.classList.add("toc-active");
          }
        })
      })
    })
  </script>

  <!--handle page scroll top and bottom, add toc-active -->
  <script type="text/javascript">
    document.addEventListener('scroll', () => {
      //scroll to bottom
      if(document.documentElement.scrollHeight === window.pageYOffset + window.innerHeight) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active")
          };
          tocItems[tocItems.length - 1].classList.add("toc-active");
        };
      //scroll to top
      if(window.pageYOffset === 0) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active");
          };
          tocItems[0].classList.add("toc-active");
        };
      })
  </script>

  <!--adjust sidebar and toc when footer is displayed -->
  <script type="text/javascript">
    sidebar = document.querySelector('.sidebar')
    toc = document.querySelector('#toc')
    main = document.querySelector('.main')
    okd_footer = document.querySelector('.footer-origin-docs')

    //handle short pages
    if (window.innerHeight === document.documentElement.scrollHeight) {
      //sidebar
      if (sidebar !== null && okd_footer == null) {
        sidebar.style.marginBottom = "38px";
        main.style.marginBottom = "35px";
      };
      //okd sidebar
      if(sidebar !== null && okd_footer !== null) {
        sidebar.style.marginBottom = "176px";
        main.style.marginBottom = "135px";
      }
    };

    //handle scrolling pages
    document.addEventListener('scroll', () => {
      //scroll to bottom
      if ($(window).width() >= 1008) {
        if(sidebar !== null) {
          //pages with multiple toc entries
          if(document.documentElement.scrollHeight === window.pageYOffset + window.innerHeight) {
              //sidebar
              if (sidebar !== null && okd_footer == null){
                sidebar.style.marginBottom = "38px";
                main.style.marginBottom = "35px";
              };
              //toc
              if (toc !== null && okd_footer == null){
                toc.style.bottom = "35px";
              };
              //okd sidebar
              if(sidebar !== null && okd_footer !== null) {
                sidebar.style.marginBottom = "176px";
                main.style.marginBottom = "135px";
              };
              //okd toc
              if (toc !== null && okd_footer !== null){
                toc.style.bottom = "175px";
              };
            };
          if(document.documentElement.scrollHeight != window.pageYOffset + window.innerHeight) {
            sidebar.style.marginBottom = "0px";
            if (toc !== null) {
              toc.style.bottom = "0px";
            }
          }
        }
      }
    })
  </script>

  <!-- adjust alerts on mobile -->
  <script type="text/javascript">
    alert = document.querySelector('#support-alert')
    window.addEventListener("wheel", () => {
      if ($(window).width() < 1008) {
        //adjust alert
        if(window.pageYOffset > 0) {
          if(alert !== null) {
            document.querySelector('#support-alert').style.position = "fixed";
            document.querySelector('#support-alert').style.bottom = "0px";
            document.querySelector('#support-alert').style.margin = "5px";
            document.querySelector('#support-alert').style.zIndex = "9999999";
          }
        }
      }
   });
    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        if(alert !== null) {
          document.querySelector('#support-alert').style.removeProperty('position');
          document.querySelector('#support-alert').style.removeProperty('bottom');
          document.querySelector('#support-alert').style.removeProperty('margin');
          document.querySelector('#support-alert').style.removeProperty('zIndex');
        }
      }
    })
  </script>

</body>
</html>